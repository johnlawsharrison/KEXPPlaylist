language: python
dist: bionic
git:
  depth: false
services:
- postgresql
python:
- '3.6'
install:
- cd backend
- pip install -r requirements.txt
- python manage.py migrate
script:
- python manage.py test
deploy:
  provider: script
  script: bash deploy.sh
  on:
    branch: master
env:
  global:
  - secure: QF5K6e5yLapBVihMUtfd11G7FV1gNOaXn0Xbaf3mkN8BlGhdpOcOrcRlNErHaUJPUHuR2IQtVveAJj6lb1h6OSI+uJX2NbxUo7EzrX0IgSvC7nh4tLBSXkhJspdD6dWhQ96OX+WKqHAXnICxnAfxnv24ybh1BThillPOSjtYPjVOa3VLFsXqb6fzG1LnWVtTNxOknmgXyR7JJUjnUx4YG9kYgItLSv2J6tGcMI3TSyf4TquOB7Xp6/O+3S4dHIQk0fMhVFMvHdcxWEbgNc5ZRPFXcF1wMNbPJGBmdn31pRcaa9UjemFxSpYmt5KGlFh/0GJXc4MvArzwjDKvGA3n83mal9h6izhPB4O2G00zeOT808g5eb8mNaeaeVZmjKdEHcykZWtA7A538wOQm6+2QeMoQhfuSG71x1y3Dqzknl7sveW+VcIMh1puSW70FzqELL21NK8WINmc85xY+RZWLzX8IOLUA4mQVQxFbP1bqsw2x3FWm1QHgxEM0E3Ie+bW1+zaCS4/kIkHTk+EgjnpwU7wIm9lI2TPosbOWtBgWFA8jU+w/bMMc4loV/ghniRjbLeGoj8tQTeFY5O+M6kK7vjmBMVNr779n4KAMECygBGox5e2Wm36sxrKW0bG0LG9PAs53z6pCpFZvLpnCegE92SmncUMw4bKxgqaYbBxR2k=
  - secure: Q1ualh7M0g3yF66eI0poN+vYOPD0wvGLgekz+FwMt1TpEimcUjjVY/H4a1NjWPxaj1gCbyJXPr9PWjcA5gGCFeQ5Pl9Zoe+HAdue9mfyqaY9ALG/tZod9K6a1/okbQqPQGnBKHnefbhGxtfaUSmIlOS5KlPPHI+ko69d8akWVNuQV25X+ZaNDplVaWaOt7Ad6fCSYEFrq5+NilSb8NMfrF0bxGpJhszdgZtqyrxB4eOsYri9Sq/+25r7mwlAfUQIL1d+qzzzOEhStCw97zzd/ZFaBG213Qi4WFojQhjvq4tGHkkCUjGGK6CC+qP6dnH4jDXqyScTwLQE48wrwLBzazaknXMzWtHmgfrPRUbp0dMYBYr3UnFU3smb7fogW5w+xfJrwOl8FVSHf/yhM5eSPJ1Ii+7GucTfPhkiL9UVy5RFxUizRlRUaglC13zCnTxUCVQI4qrBMkBR01GkGtdNvXUGJd9N+8aXuIiUcq8d0HU/K9ddh7Veq+3UWuAK9AltJtNrXLSpEzLL8GahPc8F4E6o4scIWIMnqtWxr0nS+/GaL7772POAkVIoGcHjW8FJYX7TRV7fvajksVAK9eDN1EGhBz5Ed9XtV+jrQl3N450QKIf9ofuxOXxIi7R1lLcH7ElIKhQA7cfsu558p+Z3MRP6lHN0ysEi2B35+Iyu2z0=
  - secure: YW8PDSoOBhIFGbF1fzFuVKAjshil9kvM0r+1cHiRb5qjyq7dZ3JFBlQlsj8bEZF7rApTnzwPRQ2tRp+DwFCI5i7k4fC17ASxn1pHQVsAcUWWM4l0ojy1wYzaQ8ldMqDinBn6+ydsx2DbdEeu4r8i0xpGSc4LceQjQvjErz6bw2BkGCjAAyKVviH45lPxcUaP0XnKjprXIMz/HKBj3ZejklfoAzlmzHFamTv/X10RD73Ywdp/7qVvXsxEWimpuiKdhlwF51ChcIecTgZ4drDB31BSh6Ill/PL8Koj4CuvpgoMJWfHWsto/lfCkLNuOj2Mc3D1zi9KXoWDyrOrTbBQuWHD4QSxHnatHenJlcfQCzXB3rIB8/5F+C3Oce9uBKH5o+ZdKFWaVl3L+pzm+YtQNr8EolRVAQxDTf/gdAlAz4WksEQf3bGuluQdX4XIA+ZRfZs1X+iP7U5OM/SmDFqcikHSmTATXL8OM1Wdhm8ls9AlZHpKYU6Cy1MdV0qyU4Ql2a49QWWRWvqzZBnbshv7zw5O1mzs94ny9p6+zkLckwkE3qYPprUhz/UpPTydH4Fyba2zCoOVNo60hSlHpPaIOVddjA5SK7M8l4sK5CnpipFrnF13FWlqJ3vAHZJZD3LtBK31kTP7Cf/0cLU6/NVIUaU7uWxdmZEMf2Z7JvGDPeQ=
  - secure: jOtbQEBjSyjaMwgrnUbZ84O1jv7Xv0mZeigVbFjx9WavWYwpmA3wlv/Oj5KG2tuCcWZvKR9QIDOTpON4Gr9Rdtlf+gKZ2Jj3KO6C6JaNiU+Da3ClC5+H912j4fa4brPn8w1IBjOVsYzzV1WpJ+3CoMu6mlBVbO6WaQXvPa6fIfAxUrm2cSVUOjPHKWKr7SABkQHqog3NaYdoMP2qUoVifgcO7JVQwP2UPuOOknO/BmU8pK/WuHxnLtwzF8Vao/m0otBKdq0URs4QHpxiy8+mKv8JQ24nCA5FP0+qovQXhfg0isu0KQTUJAe47iKKgkldACHCeo1xLHmSpfXP19sugNd3cDtYK8iqT+WrhqNUg1AQJMuhl4rzJTljGt7Ch6B9vVm77tcccTmDuMzGWTm3mxdLgjKFSa6h5A4XrYUFlFaQi3x8bF5D9LdovrR0z9pZUQbmx4f0kp4BLuO8Xz9zLjqp6XZNjVBUTVOQS9Lxnr1cQMmbkGO+cTfsfGweW7xPlpkfRIdPi2kIySFLBvXVnUgnb7m/MeXbWz1w8yN7aEmkT9OnHpLRf86oNgZrXG3LcORxwFpGMOuMfjX4LdcFRbqMsKEUh82KsEn59uXUIZlCV/Gc/7Zb1od/alR9KwyQjlNE0tqAV0SfqavaOFnK45sbvW7c4DbUSo29LD1G+n0=
before_deploy:
- openssl aes-256-cbc -K $encrypted_eb6eb26fba1d_key -iv $encrypted_eb6eb26fba1d_iv
  -in travis_deploy_rsa.enc -out travis_deploy_rsa -d
- eval "$(ssh-agent -s)"
- chmod 600 travis_deploy_rsa
- ssh-add travis_deploy_rsa
- echo -e "Host ${DEPLOY_HOST}\n\tStrictHostKeyChecking no\n" >> ~/.ssh/config
